
# üì¶ Drone Delivery Platform

## –í–Ω–µ—à–Ω—è—è API-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Magnum

**–î–æ–∫—É–º–µ–Ω—Ç:** External API Spec
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0.0
**–í–µ—Ä—Å–∏—è API:** v1
**–°—Ç–∞—Ç—É—Å:** Production-ready (–¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
**–î–∞—Ç–∞:** 8 —è–Ω–≤–∞—Ä—è 2026
**–ü—Ä–æ—Ç–æ–∫–æ–ª:** HTTPS (REST) + WebSocket (—Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è)
**–§–æ—Ä–º–∞—Ç:** JSON (UTF-8)
**–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å:** UTC
**Base URL:** `https://api.<your-domain>/api/v1` *(–∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –¥–æ–º–µ–Ω)*

---

## 1) –¶–µ–ª—å –¥–æ–∫—É–º–µ–Ω—Ç–∞

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç **–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** –º–µ–∂–¥—É:

* **Magnum** ‚Äî –≤–ª–∞–¥–µ–ª–µ—Ü –∑–∞–∫–∞–∑–æ–≤/–∫–ª–∏–µ–Ω—Ç–æ–≤/—Ç–æ–≤–∞—Ä–æ–≤, –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –¥–æ—Å—Ç–∞–≤–∫—É
* **Drone Delivery Platform (–º—ã)** ‚Äî —É–ø—Ä–∞–≤–ª—è–µ—Ç –¥—Ä–æ–Ω–æ–º, –º–∞—Ä—à—Ä—É—Ç–æ–º, —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–µ–π –∏ —Ñ–∞–∫—Ç–æ–º –¥–æ—Å—Ç–∞–≤–∫–∏

API –ø–æ–∑–≤–æ–ª—è–µ—Ç:

* —Å–æ–∑–¥–∞–≤–∞—Ç—å –¥–æ—Å—Ç–∞–≤–∫—É –ø–æ –∑–∞–∫–∞–∑—É Magnum
* –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –¥–æ—Å—Ç–∞–≤–∫—É –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
* –ø–æ–ª—É—á–∞—Ç—å —Å—Ç–∞—Ç—É—Å—ã –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–æ—Å—Ç–∞–≤–∫–∏
* –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—Ç–º–µ–Ω—ã/—Å–±–æ–∏/–≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏

---

## 2) –†–æ–ª–∏ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å —Å—Ç–æ—Ä–æ–Ω

### 2.1 Magnum –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞

* —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ (order) –∏ –µ–≥–æ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É
* –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞ (–§–ò–û, —Ç–µ–ª–µ—Ñ–æ–Ω)
* –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ (–≤ —Ç.—á. –≥–µ–æ–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã)
* –æ–ø–ª–∞—Ç—É/–≤–æ–∑–≤—Ä–∞—Ç—ã/–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é —Å –∫–ª–∏–µ–Ω—Ç–æ–º (–µ—Å–ª–∏ –Ω–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ –∏–Ω–∞—á–µ)

### 2.2 Drone Platform –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞

* –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –¥—Ä–æ–Ω–∞
* –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞
* –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª—ë—Ç–∞
* —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—é –∏ —Å—Ç–∞—Ç—É—Å
* –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã (–≤–µ—Ç–µ—Ä, —Å–≤—è–∑—å, –≤–æ–∑–≤—Ä–∞—Ç, –æ—Ç–∫–∞–∑)

üìå **Magnum –Ω–µ —É–ø—Ä–∞–≤–ª—è–µ—Ç –¥—Ä–æ–Ω–æ–º –Ω–∞–ø—Ä—è–º—É—é** ‚Äî —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ —Å–æ–∑–¥–∞–Ω–∏–µ/–æ—Ç–º–µ–Ω—É –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤.

---

## 3) –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API

–í—Å–µ endpoints –æ–±—è–∑–∞–Ω—ã –∏–º–µ—Ç—å –≤–µ—Ä—Å–∏—é –≤ URL:

* `/api/v1/...`

–ü—Ä–∞–≤–∏–ª–∞:

* **–ª–æ–º–∞—é—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** ‚Üí –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è (`v2`)
* **–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π** ‚Üí –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ (backward compatible)
* —Å—Ä–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏ ‚Äî **–º–∏–Ω–∏–º—É–º 6 –º–µ—Å—è—Ü–µ–≤** –ø–æ—Å–ª–µ –∞–Ω–æ–Ω—Å–∞ deprecation

---

## 4) –û–∫—Ä—É–∂–µ–Ω–∏—è (Environments)

### 4.1 Sandbox (—Ç–µ—Å—Ç)

* Base URL: `https://sandbox-api.<your-domain>/api/v1`

### 4.2 Production

* Base URL: `https://api.<your-domain>/api/v1`

---

## 5) SLA / SLO (–≥–∞—Ä–∞–Ω—Ç–∏–∏ —Å–µ—Ä–≤–∏—Å–∞)

> –ó–Ω–∞—á–µ–Ω–∏—è –Ω–∏–∂–µ ‚Äî **—Ü–µ–ª–µ–≤—ã–µ**. –ù–∞ —ç—Ç–∞–ø–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –º–æ–∂–Ω–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —é—Ä–∏–¥–∏—á–µ—Å–∫–∏.

### 5.1 –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å

* **Uptime API:** 99.5% –≤ –º–µ—Å—è—Ü

### 5.2 –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞

* P95 latency –¥–ª—è REST API: **‚â§ 500 –º—Å**
* WebSocket telemetry –∑–∞–¥–µ—Ä–∂–∫–∞: **‚â§ 2 —Å–µ–∫** (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å–≤—è–∑–∏)

### 5.3 –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤

* Critical (–ø–æ–ª–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ): —Ä–µ–∞–∫—Ü–∏—è **‚â§ 30 –º–∏–Ω**
* Major (—á–∞—Å—Ç–∏—á–Ω–∞—è –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è): —Ä–µ–∞–∫—Ü–∏—è **‚â§ 2 —á–∞—Å–∞**
* Minor: —Ä–µ–∞–∫—Ü–∏—è **‚â§ 1 —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å**

---

## 6) Rate Limiting (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è)

### 6.1 REST API

* **100 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω** –Ω–∞ –∫–ª—é—á (API Key/JWT client)
* burst –¥–æ **200/–º–∏–Ω** –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–ø–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—é)

### 6.2 WebSocket

* **1 –∞–∫—Ç–∏–≤–Ω–æ–µ WS-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** –Ω–∞ `delivery_id`
* max **50 –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π** –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–∞ –æ–¥–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

### 6.3 –û—Ç–≤–µ—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞

HTTP `429 Too Many Requests`

```json
{
  "error": "RATE_LIMIT_EXCEEDED",
  "message": "Too many requests",
  "retry_after_seconds": 30
}
```

---

## 7) –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### 7.1 –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–û–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ (—Ñ–∏–∫—Å–∏—Ä—É–µ–º –≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ):

**JWT**

```http
Authorization: Bearer <jwt>
```

**API Key**

```http
X-API-KEY: <api_key>
```

### 7.2 TLS

* —Ç–æ–ª—å–∫–æ HTTPS
* TLS 1.2+

### 7.3 IP Whitelist (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

* Magnum –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ø–∏—Å–æ–∫ –∏—Å—Ö–æ–¥—è—â–∏—Ö IP ‚Üí –º—ã —Ä–∞–∑—Ä–µ—à–∞–µ–º –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ —Å –Ω–∏—Ö

### 7.4 –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏)

–î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –ø–æ–≤—Ç–æ—Ä–æ–≤ Magnum –¥–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å:

```http
Idempotency-Key: <uuid>
```

–ï—Å–ª–∏ Magnum –ø–æ–≤—Ç–æ—Ä–∏—Ç –∑–∞–ø—Ä–æ—Å —Å —Ç–µ–º –∂–µ –∫–ª—é—á–æ–º ‚Äî –º—ã –≤–µ—Ä–Ω—ë–º —Ç–æ—Ç –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–∞ –Ω–µ —Å–æ–∑–¥–∞–¥–∏–º –¥—É–±–ª—å).

---

## 8) Webhook/Callback –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

–ï—Å–ª–∏ Magnum —Ö–æ—á–µ—Ç –ø–æ–ª—É—á–∞—Ç—å —Å—Ç–∞—Ç—É—Å—ã ‚Äúpush‚Äù, –∞ –Ω–µ ‚Äúpoll‚Äù, –≤–∫–ª—é—á–∞–µ–º webhooks.

### 8.1 –ü–æ–¥–ø–∏—Å—å webhook (HMAC)

–ú—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º:

* `X-Signature: sha256=<hex>`
* `X-Timestamp: <unix_seconds>`

–ü–æ–¥–ø–∏—Å—å —Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–∞–∫:

```
HMAC_SHA256(secret, timestamp + "." + raw_body)
```

### 8.2 –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–æ–≤ (replay)

Magnum –¥–æ–ª–∂–µ–Ω –æ—Ç–∫–ª–æ–Ω—è—Ç—å webhook, –µ—Å–ª–∏:

* timestamp —Å—Ç–∞—Ä—à–µ **5 –º–∏–Ω—É—Ç**

---

## 9) –°—É—â–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö (Domain Model)

### 9.1 –û—Å–Ω–æ–≤–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã

* `order_id` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–∫–∞–∑–∞ –≤ —Å–∏—Å—Ç–µ–º–µ Magnum
* `delivery_id` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–æ—Å—Ç–∞–≤–∫–∏ –≤ –Ω–∞—à–µ–π —Å–∏—Å—Ç–µ–º–µ

### 9.2 –ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏

```json
{
  "latitude": 43.238949,
  "longitude": 76.889709,
  "altitude": 0,
  "address_text": "–ê–ª–º–∞—Ç—ã, —É–ª. –ê–±–∞—è 10",
  "entrance": "2",
  "floor": 5,
  "apartment": "52",
  "comment": "–ü–æ–∑–≤–æ–Ω–∏—Ç—å –∑–∞ 5 –º–∏–Ω—É—Ç"
}
```

### 9.3 –ì—Ä—É–∑ (payload)

```json
{
  "weight_kg": 2.4,
  "volume_l": 4.0,
  "temperature_required": true,
  "min_temperature_c": 2,
  "max_temperature_c": 6,
  "fragile": false
}
```

### 9.4 –ö–ª–∏–µ–Ω—Ç

```json
{
  "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "phone": "+77071234567"
}
```

---

## 10) –°—Ç–∞—Ç—É—Å—ã –¥–æ—Å—Ç–∞–≤–∫–∏

| –°—Ç–∞—Ç—É—Å             | –°–º—ã—Å–ª                              |
| ------------------ | ---------------------------------- |
| `CREATED`          | –¥–æ—Å—Ç–∞–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞                   |
| `VALIDATING`       | –≤–∞–ª–∏–¥–∞—Ü–∏—è –∞–¥—Ä–µ—Å–∞/–º–∞—Å—Å—ã/–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π |
| `REJECTED`         | –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ (–Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å)   |
| `ASSIGNED`         | –Ω–∞–∑–Ω–∞—á–µ–Ω –¥—Ä–æ–Ω                      |
| `LOADING`          | –∑–∞–≥—Ä—É–∑–∫–∞ –≥—Ä—É–∑–∞                     |
| `READY_TO_TAKEOFF` | –≤—Å—ë –≥–æ—Ç–æ–≤–æ                         |
| `IN_FLIGHT`        | –ø–æ–ª—ë—Ç                              |
| `APPROACHING`      | –ø–æ–¥–ª–µ—Ç–∞–µ—Ç –∫ —Ç–æ—á–∫–µ                  |
| `DELIVERED`        | –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ                         |
| `RETURNING`        | –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –Ω–∞ –±–∞–∑—É               |
| `FAILED`           | –Ω–µ—É–¥–∞—á–∞ (–∏–Ω—Ü–∏–¥–µ–Ω—Ç)                 |
| `CANCELLED`        | –æ—Ç–º–µ–Ω–µ–Ω–æ                           |

---

# 11) REST API ‚Äî Magnum ‚Üí Drone Platform

## 11.1 –°–æ–∑–¥–∞—Ç—å –¥–æ—Å—Ç–∞–≤–∫—É

**POST** `/deliveries`

**Headers**

* `Authorization` –∏–ª–∏ `X-API-KEY`
* `Idempotency-Key: <uuid>` *(–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)*

### Request

```json
{
  "order_id": "MAG-923842",
  "customer": {
    "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
    "phone": "+77071234567"
  },
  "delivery_address": {
    "latitude": 43.238949,
    "longitude": 76.889709,
    "altitude": 0,
    "address_text": "–ê–ª–º–∞—Ç—ã, —É–ª. –ê–±–∞—è 10",
    "entrance": "2",
    "floor": 5,
    "apartment": "52",
    "comment": "–ü–æ–∑–≤–æ–Ω–∏—Ç—å –∑–∞ 5 –º–∏–Ω—É—Ç"
  },
  "payload": {
    "weight_kg": 2.4,
    "volume_l": 4.0,
    "temperature_required": true,
    "min_temperature_c": 2,
    "max_temperature_c": 6,
    "fragile": false
  },
  "preferred_delivery_window": {
    "from_utc": "2026-01-08T10:00:00Z",
    "to_utc": "2026-01-08T12:00:00Z"
  }
}
```

### Response 201

```json
{
  "delivery_id": "DLV-100239",
  "order_id": "MAG-923842",
  "status": "CREATED",
  "created_at_utc": "2026-01-08T09:12:00Z",
  "tracking": {
    "status_url": "/api/v1/deliveries/DLV-100239",
    "websocket_url": "wss://api.<your-domain>/ws/v1/deliveries/DLV-100239"
  }
}
```

### –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏

* `400 INVALID_REQUEST` ‚Äî –ø–ª–æ—Ö–æ–π JSON/–ø–æ–ª—è
* `409 DUPLICATE_ORDER` ‚Äî —Ç–∞–∫–æ–π `order_id` —É–∂–µ –µ—Å—Ç—å
* `422 DELIVERY_NOT_POSSIBLE` ‚Äî –Ω–µ–ª—å–∑—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å (–∑–æ–Ω–∞, –º–∞—Å—Å–∞, –ø–æ–≥–æ–¥–∞)
* `500 INTERNAL_ERROR`

---

## 11.2 –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å –¥–æ—Å—Ç–∞–≤–∫–∏

**GET** `/deliveries/{delivery_id}`

### Response 200

```json
{
  "delivery_id": "DLV-100239",
  "order_id": "MAG-923842",
  "status": "IN_FLIGHT",
  "eta_utc": "2026-01-08T09:35:00Z",
  "last_update_utc": "2026-01-08T09:20:21Z"
}
```

---

## 11.3 –û—Ç–º–µ–Ω–∏—Ç—å –¥–æ—Å—Ç–∞–≤–∫—É

**POST** `/deliveries/{delivery_id}/cancel`

### Request

```json
{
  "reason": "CUSTOMER_REQUEST"
}
```

### Response 200

```json
{
  "delivery_id": "DLV-100239",
  "status": "CANCELLED",
  "cancelled_at_utc": "2026-01-08T09:14:05Z"
}
```

**–ü—Ä–∞–≤–∏–ª–∞ –æ—Ç–º–µ–Ω—ã**

* –µ—Å–ª–∏ `IN_FLIGHT` ‚Äî –æ—Ç–º–µ–Ω–∞ –º–æ–∂–µ—Ç –ø–µ—Ä–µ–π—Ç–∏ –≤:

  * `RETURNING` (–¥—Ä–æ–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≥—Ä—É–∑)
  * –∏–ª–∏ `FAILED` –µ—Å–ª–∏ —É–∂–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–∞–¥–∏—è (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ–≥–ª–∞–º–µ–Ω—Ç–æ–≤)

---

# 12) Real-time Tracking ‚Äî WebSocket

**WS** `wss://api.<your-domain>/ws/v1/deliveries/{delivery_id}`

### –°–æ–æ–±—â–µ–Ω–∏–µ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏

```json
{
  "type": "TELEMETRY",
  "timestamp_utc": "2026-01-08T09:20:21Z",
  "delivery_id": "DLV-100239",
  "drone": {
    "latitude": 43.240102,
    "longitude": 76.892100,
    "altitude_m": 120,
    "speed_mps": 14.5,
    "heading_deg": 270,
    "battery_percent": 78,
    "gps_accuracy_m": 3.2,
    "link_quality_percent": 92
  },
  "payload": {
    "temperature_c": 4.1
  },
  "eta_utc": "2026-01-08T09:35:00Z"
}
```

### –°–æ–æ–±—â–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞

```json
{
  "type": "STATUS",
  "timestamp_utc": "2026-01-08T09:22:00Z",
  "delivery_id": "DLV-100239",
  "status": "APPROACHING"
}
```

---

# 13) Webhooks ‚Äî Drone Platform ‚Üí Magnum (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ Magnum —Ö–æ—á–µ—Ç –ø–æ–ª—É—á–∞—Ç—å push-–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.

## 13.1 Endpoint Magnum

Magnum –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç URL:

* `https://magnum.kz/api/drone-delivery/events`

## 13.2 –°–æ–±—ã—Ç–∏–µ —Å—Ç–∞—Ç—É—Å–∞ (–ø—Ä–∏–º–µ—Ä)

```json
{
  "event_id": "EVT-9001",
  "event_type": "DELIVERY_STATUS",
  "timestamp_utc": "2026-01-08T09:37:11Z",
  "order_id": "MAG-923842",
  "delivery_id": "DLV-100239",
  "status": "DELIVERED"
}
```

---

# 14) –û—à–∏–±–∫–∏: —Ñ–æ—Ä–º–∞—Ç + —Ç–∞–±–ª–∏—Ü–∞

## 14.1 –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—à–∏–±–∫–∏

```json
{
  "error": "INVALID_COORDINATES",
  "message": "Latitude/Longitude out of bounds",
  "details": {
    "latitude": 200
  },
  "trace_id": "d9f1b2c3a1"
}
```

## 14.2 –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—à–∏–±–æ–∫

* **Fatal (–Ω–µ –ø–æ–≤—Ç–æ—Ä—è—Ç—å)**

  * `INVALID_REQUEST`
  * `DELIVERY_NOT_POSSIBLE`
  * `UNAUTHORIZED`
* **Retryable (–ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–∑–∂–µ)**

  * `RATE_LIMIT_EXCEEDED`
  * `TEMPORARY_UNAVAILABLE`

---

# 15) –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏ (Edge Cases)

## 15.1 –ü–æ—Ç–µ—Ä—è —Å–≤—è–∑–∏ —Å –¥—Ä–æ–Ω–æ–º

* —Å—Ç–∞—Ç—É—Å –º–æ–∂–µ—Ç –ø–µ—Ä–µ–π—Ç–∏ –≤ `FAILED`
* Magnum –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ `INCIDENT_LINK_LOSS`

## 15.2 –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤—ã—à–ª–∞ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã

* —Å–æ–±—ã—Ç–∏–µ `INCIDENT_TEMPERATURE_OUT_OF_RANGE`
* –≤–æ–∑–º–æ–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—Ç: `RETURNING`

## 15.3 –ö–ª–∏–µ–Ω—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

* —Å—Ç–∞—Ç—É—Å `FAILED` –∏–ª–∏ `RETURNING`
* Magnum –¥–æ–ª–∂–µ–Ω —Ä–µ—à–∏—Ç—å –¥–∞–ª—å–Ω–µ–π—à–∏–µ –¥–µ–π—Å—Ç–≤–∏—è (–ø–æ–≤—Ç–æ—Ä/–≤–æ–∑–≤—Ä–∞—Ç/—É—Ç–∏–ª–∏–∑–∞—Ü–∏—è –ø–æ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—É)

## 15.4 –ù–µ–≤–µ—Ä–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–ª–∏ –∑–æ–Ω–∞ –∑–∞–ø—Ä–µ—Ç–∞

* —Å—Ä–∞–∑—É `REJECTED` —Å –ø—Ä–∏—á–∏–Ω–æ–π

---

# 16) –ü–æ–ª–Ω—ã–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª (End-to-End –ø—Ä–∏–º–µ—Ä)

1. Magnum —Å–æ–∑–¥–∞—ë—Ç –¥–æ—Å—Ç–∞–≤–∫—É
   `POST /deliveries` ‚Üí `201 CREATED` + `delivery_id`

2. Magnum –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç
   `GET /deliveries/{id}` –∏–ª–∏ WS

3. —Å—Ç–∞—Ç—É—Å—ã –∏–¥—É—Ç:
   `CREATED ‚Üí ASSIGNED ‚Üí LOADING ‚Üí IN_FLIGHT ‚Üí APPROACHING ‚Üí DELIVERED`

4. Magnum –ø–æ–ª—É—á–∞–µ—Ç:

* –ª–∏–±–æ —á–µ—Ä–µ–∑ `GET`
* –ª–∏–±–æ —á–µ—Ä–µ–∑ `WebSocket`
* –ª–∏–±–æ —á–µ—Ä–µ–∑ `Webhook` (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)

---

# 17) Onboarding –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è Magnum

1. –æ–±–º–µ–Ω –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ (tech + security)
2. –≤—ã–¥–∞—á–∞ API Key / JWT client
3. IP whitelist
4. –≤—ã–¥–∞—á–∞ webhook secret (–µ—Å–ª–∏ webhooks)
5. —Ç–µ—Å—Ç –≤ sandbox
6. –∑–∞–ø—É—Å–∫ –≤ production

---

# 18) –ö–æ–Ω—Ç–∞–∫—Ç—ã (Support)

*(–∑–∞–ø–æ–ª–Ω–∏ —Å–≤–æ–∏–º–∏ —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏)*

* **Technical integration:** integration@<your-domain>
* **24/7 incidents:** noc@<your-domain>
* **Business:** partners@<your-domain>

---

# 19) Changelog

## 1.0.0 ‚Äî 2026-01-08

* Initial production-ready external API spec
* Added security, webhooks signing, SLA, rate limits, edge cases, lifecycle example

---

## 20) –ü—Ä–∏–º–µ—á–∞–Ω–∏—è –∫ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ (Backward Compatibility)

* Magnum –¥–æ–ª–∂–µ–Ω –ø–∞—Ä—Å–∏—Ç—å JSON –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É:

  * **–Ω–µ –ø–∞–¥–∞—Ç—å**, –µ—Å–ª–∏ –ø–æ—è–≤–∏–ª–∏—Å—å –Ω–æ–≤—ã–µ –ø–æ–ª—è
  * –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –ø–æ–ª—è

